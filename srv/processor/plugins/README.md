# 处理方法和返回后的去乱码需要严格按照py进行，只有一点：<br/>现在是<br>了
latest_tips:
([\d]{4}-[\d]{2}-[\d]{2})每股资本公积[：:]([^营]+)营业收入\(万元\)[：:]([\d\s.｜-]+)(?:同比增([^%]+%))?
([\d]{4}-[\d]{2}-[\d]{2})每股未分利润[：:]([^净]+)净利润\(万元\)[：:]([\d\s.｜-]+)(?:同比增([^%]+%))?
【质押占比】[：:]控股股东([^\d]+)累计质押占其持股比例([^%]+%)
发行前股份限售流通\(([\d-]{10})\)[：:]([^股]+)万?股
★股改限售流通\(([\d-]{10})\)[:：]{1}([^股]+?)万?股\(详见股本结构\)｜<br>
增发A股法人配售上市\(([\d-]{10})\)[：:]([^股]+)万?股
股权激励限售流通\(([\d-]{10})\)[：:]([^股]+)万?股
无限售不减持承诺到期\(([\d-]{10})\)[：:]([^股]+)万?股
★最新公告[:：]?(.*?)[★【]{1}
★最新报道[:：]?(.*?)[★【]{1}
【业绩预告】[:：]?(.*?)[【★]{1}
★特别处理[:：]?(.*?)｜<br>
增发】[:：]?(.*?)[【★]{1}
★股东户数变化[:：]?(.*?)[【★]{1}
	截止([\d]{4}-[\d]{2}-[\d]{2}),公司股东数([\d]+),比上期\(([\d]{4}-[\d]{2}-[\d]{2})\)([\D]{2})([\d]+)户,幅度([^%]+%)\(详见主力追踪\)  //增减与幅度符号偶尔不一致
		截止([\d]{4}-[\d]{2}-[\d]{2}),公司股东数([\d]+),比上期\(([\d]{4}-[\d]{2}-[\d]{2})\)不变,幅度[^%]+%\(详见主力追踪\)   //不变
		截止([\d]{4}-[\d]{2}-[\d]{2}),公司股东数([\d]+),幅度-%\(详见主力追踪\)      //不变

		
latest_tips = {
	"公积":{"更新日期":"", "每股公积":"", "营收万元":"", "同比增":""},
	"未分":{"更新日期":"", "每股未分":"", "净利万元":"", "同比增":""},
	"质押":{"股东":"", "占比":""},
	"发行前限售":{"日期":"", "股数":""}, //股数 可带 万
	"股改限售":{"日期":"", "股数":""}, //股数 可带 万
	"增发A股":{"日期":"", "股数":""}, //股数 可带 万
	"激励限售":{"日期":"","股数":""}, //股数 可带 万
	"承诺到期":{"日期":"","股数":""}, //股数 可带 万
	"最新公告":{"msg":""},
	"最新报道":{"msg":""},
	"业绩预告":{"msg":""},
	"特别处理":{"msg":""},
	"最新提醒增发":{"msg":""},
	"股东户数变化":{"本期":"","股东数":"","上期":"", "增减":"","户数":"","幅度":""}


}

import csv,re
with open('C:/Users/pkwcc/Desktop/res_2019-11-19.csv', 'r', newline='', encoding="utf-8-sig", errors="ignore") as csvfile:
    reader = csv.DictReader(csvfile)
    res=[]

    for row in reader:
        if '★股东户数变化' in row['content']:
            code=row['code']
            body=row['content']
            t=re.search("★股东户数变化[:：]?(.*?)[【★]{1}",body)
            if t:
                s= t.group(1)
                d = {"[｜─├┤└┘]+": "", '(&nbsp;)+': '', '<br/>': ''}
                for i in d:
                    s = re.sub(i, d[i], s)
                res.append(s.strip())
            else:
                print(code)
                break

    for i in res:
        t=re.search('截止([\d]{4}-[\d]{2}-[\d]{2}),公司股东数([\d]+),比上期\(([\d]{4}-[\d]{2}-[\d]{2})\)([\D]{2})([\d]+)户,幅度([^%]+%)\(详见主力追踪\)',i)
        if t:
            # pass
            if t.group(4)=="减少":
                if not t.group(6).startswith("-"):
                    print(i)
            else:
                if t.group(6).startswith("-"):
                    print(i)
        elif re.search('截止([\d]{4}-[\d]{2}-[\d]{2}),公司股东数([\d]+),比上期\(([\d]{4}-[\d]{2}-[\d]{2})\)不变,幅度[^%]+%\(详见主力追踪\)',i):
            pass
        elif re.search('截止([\d]{4}-[\d]{2}-[\d]{2}),公司股东数([\d]+),幅度-%\(详见主力追踪\)',i):
            pass
        else:
            print(i)
